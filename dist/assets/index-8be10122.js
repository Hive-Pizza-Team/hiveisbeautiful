(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const J={appNames:[],customJsonPrefixes:["archmage_"],hiveEngineSymbols:["ARCHMAGE","ARCHMAGEA","ARCHMAGEB","ARCHMAGEM"],color:"blue",label:"Archmage"},_={appNames:["actifit"],color:"red",customJsonPrefixes:["actifit"],hiveEngineSymbols:["AFIT","AFITX"],label:"Actifit"},E={appNames:["beem","beempy"],color:"gray",label:"beem"},q={appNames:["beerlover"],color:"orange",hiveEngineSymbols:["BEER"],label:"Beer"},C={appNames:[],customJsonPrefixes:["cbm_"],hiveEngineSymbols:[""],color:"lightgreen"},A={appNames:[],customJsonPrefixes:[],hiveEngineSymbols:[""],color:"yellow-orange"},I={appNames:["CS"],color:"blue",label:"CS"},j={appNames:[],customJsonPrefixes:["dcrops"],hiveEngineSymbols:[""],color:"lightgreen",label:"dCrops"},T={appNames:["dbuzz"],color:"red",label:"dBuzz"},z={customJsonPrefixes:["dlux_"],label:"DLUX",color:"lightgreen"},L={appNames:[],color:"red",customJsonPrefixes:[],hiveEngineSymbols:[""],label:"Downvote"},M={appNames:["ecency"],color:"blue",label:"Ecency",customJsonPrefixes:["ecency_"],hiveEngineSymbols:[""]},W={appNames:["engage"],color:"blue",label:"Engage"},$={appNames:["engrave"],color:"blue",label:"Engrave"},D={customJsonPrefixes:["exode"],label:"Exode"},H={appNames:[],color:"blue",customJsonPrefixes:["go_"],label:"GolemO"},R={appNames:[],color:"blue",customJsonPrefixes:["gls-"],hiveEngineSymbols:[""],label:"GLS"},U={appNames:[],color:"red",customJsonPrefixes:["ssc-mainnet","scot_"],hiveEngineSymbols:[""],label:"H-E"},B={"app-names":[],color:"lightgreen",customJsonPrefixes:["qwoyn_"],hiveEngineSymbols:["BUDS","BUDSX","EXP"],label:"HashKings"},F={color:"hotpink",customJsonPrefixes:["pp_video"],label:"HiveTube"},G={"app-names":[],color:"purple","custom-json-ids":[],hiveEngineSymbols:["ZING"],label:"Holo"},Z={color:"yellow"},X={appNames:["leothreads","leofinance"],color:"yellow",customJsonPrefixes:["leo_"],label:"INLEO",url:"https://inleo.io"},K={appNames:"la-colmena"},V={customJsonPrefixes:["lensy_"],label:"Lensy"},Q={appNames:["liketu"],color:"bluegreen",customJsonPrefixes:["react"],label:"liketu",url:"https://www.liketu.com/"},Y={color:"blue",customJsonPrefixes:["mole-miner-"],label:"MuTerra"},ee={color:"orange",customJsonPrefixes:["nftmart"],label:"NFTMart",url:"https://nftm.art"},oe={customJsonPrefixes:["nftsr_"],label:"NTFSR"},te={customJsonPrefixes:["op_"],label:"OP"},ne={color:"gray"},re={customJsonPrefixes:["pm_"],label:"PKM",color:"orange"},se={appNames:["peakd"],color:"lightgreen",customJsonPrefixes:["peakd_","beacon_custom_json"],label:"PeakD"},le={color:"bluegreen",customJsonPrefixes:["pigs_expired/1","reject_order/1","game_request/1","pack_purchase/1","confirm_order/1","fulfill_pigs/1","end_game/1","gmreq_","start_game/1","game_rewards/1","pig_upgrade/1","fulfill_points/1"],label:"Piggies"},ce={appNames:["pizzabot"],color:"yellow",hiveEngineSymbols:["PIZZA"],label:"PIZZA",url:"https://hive.pizza"},ae={appNames:["Poshtoken"],color:"yellow"},ie={color:"lightgreen"},ue={color:"yellow",customJsonPrefixes:["pp_"],label:"podping"},me={label:"PoB",color:"gray"},fe={color:"bluegreen",customJsonPrefixes:["duat_"],label:"Ragnarok"},de={appNames:["somee"],color:"red",label:"Somee"},pe={appNames:["3speak","3SpeakComment"],color:"bluegreen",customJsonPrefixes:["spkcc_","3speak-"],hiveEngineSymbols:[""],label:"Spk"},be={appNames:["steemmonsters","splinterlands"],color:"green",customJsonPrefixes:["sm_","sl-","dev-sm_"],label:"SL"},ge={appNames:["steemmonsters"],color:"green",label:"Splintertalk"},ye={color:"blue"},he={color:"orange",customJsonPrefixes:["terracore_","tm_"],label:"Terracore"},ve={color:"orange"},Se={appNames:"travelfeed",color:"orange",label:"Travelfeed"},ke={appNames:["Discord"],color:"blue",label:"Qurator"},xe={color:"blue"},Ne={color:"blue",customJsonPrefixes:"vsc.",label:"VSC"},Pe={color:"orange",label:"VIMM"},Oe={appNames:["waivio"],color:"gray",customJsonPrefixes:["wobj_","waivio_"],label:"Waivio"},we={color:"yellow",customJsonPrefixes:["woo_"],hiveEngineSymbols:["WOO","WOOALPHA","WOOSATURN","WOORAVEN"],label:"WOO"},c={archmage:J,actifit:_,beem:E,beerlover:q,CBM:C,Comment:A,cryptoshots:I,dcrops:j,dbuzz:T,dlux:z,downvote:L,ecency:M,engage:W,enrave:$,exode:D,golemoverlord:H,gls:R,hiveengine:U,hashkings:B,"Hive.blog":{appNames:["hiveblog"],color:"yellow-orange",label:"hive.blog"},hivetube:F,holozing:G,Holybread:Z,inleo:X,lacolmena:K,lensy:V,liketu:Q,muterra:Y,nftmart:ee,nftshowroom:oe,oceanplanet:te,Other:ne,peakmonsters:re,peakd:se,piggericks:le,PIZZA:ce,Posh:ae,Post:ie,podping:ue,proofofbrain:me,ragnarok:fe,somee:de,spk:pe,splinterlands:be,splintertalk:ge,STEMSocial:ye,terracore:he,Xfer:ve,travelfeed:Se,qurator:ke,Up:xe,vsc:Ne,vimm:Pe,waivio:Oe,WOO:we},f=800,d=600;function k(e,t,r){return e<=t?t:e>=r?r:e}const Je=()=>Math.random()<.5?-1:1,i=e=>e*Je()*Math.random();function _e(e){var t=d3.select("svg#viz").selectAll("g").data(e);t.enter().append("g").attr("class","node").each(function(r){d3.select(this).append("circle").attr("class",function(o){return`${o.color} stroke`}).attr("r",function(o){return k(o.label.length*6.25,20,40)}),d3.select(this).append("text").attr("dominant-baseline","central").attr("text-anchor","middle").text(function(o){return o.label}).style("font-size","17px")}),t.exit().remove()}function Ee(){var e=d3.select("svg#viz").selectAll("g");e.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}function qe(e){const t=b(e);var r=g(e),o;return t?o=u(t):o=u(r),[{label:r,color:o,x:f/2+i(100),y:d/2+i(100)}]}function Ce(e){var t=[],r=e[1].json;try{r=JSON.parse(r)}catch(o){return console.warn("Invalid JSON:",o),[]}if(!r)return t;if(Array.isArray(r))for(const o of r){const s=N(o.contractPayload.symbol);if(!s)continue;const n=P(s),l=u(s);t.push({label:n,color:l,x:f/2+i(100),y:d/2+i(100)})}else if(r.contractPayload){const o=r.contractPayload.symbol,s=N(o);if(!s)return t;const n=P(s),l=u(s);console.debug(s,n,l),t.push({label:n,color:l,x:f/2+i(100),y:d/2+i(100)})}return t}function Ae(e){if(document.querySelector("#flexCheckCustomJSONs").value)return[];var t=[],r=e[1].id;r.startsWith("ssc-mainnet")&&(t=t.concat(Ce(e)));const o=b(e);var s=g(e);s||console.error("missing label for:",o);var n;return o?n=u(o):n=u(s),t.push({label:s,color:n,x:f/2+i(100),y:d/2+i(100)}),t}function Ie(e){const t=b(e);var r=g(e),o;return t?o=u(t):o=u(r),[{label:r,color:o,x:f/2+i(100),y:d/2+i(100)}]}function je(e){var t=[];return e.forEach(r=>{r.operations.forEach(o=>{const s=o[0];var n=[];s==="comment"?n=qe(o):s==="custom_json"?n=Ae(o):n=Ie(o),t=t.concat(n)})}),t}function N(e){for(const[t,r]of Object.entries(c))if(r.hiveEngineSymbols&&r.hiveEngineSymbols.includes(e))return console.debug("from HE symbol appId",t),t}function b(e){const t=e[0];var r=e[1].json_metadata;if(r)var r=JSON.parse(r);if(r&&r.app){var o=r.app;typeof o=="string"?(o=o.split("/")[0],o=o.split("-mobile-")[0]):o.name&&(o=o.name)}if(o&&console.debug("JSON app name",o),o){for(const[n,l]of Object.entries(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(o.toLowerCase()))return console.debug("appId",n),n}console.warn("Did not find app in registry: ",o)}if(t=="custom_json"){var s=e[1].id;for(const[n,l]of Object.entries(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(s.startsWith(a))return console.debug("appId",n),n}}return null}function g(e){var t=e[0];if(t=="comment"){const l=b(e);return l&&!Object.keys(c[l]).includes("label")&&console.log(l,"missing label"),l&&c[l].label?c[l].label:t.charAt(0).toUpperCase()+t.slice(1)}else if(t=="custom_json"){var r=e[1].id,o=e[1].json,s=o.app;if(typeof s=="object"&&Object.keys(s).includes("name")&&(s=s.name),s){for(const l of Object.values(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(s))return console.debug("Labeled by app name:",l.label),l.label}}for(const l of Object.values(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(r.startsWith(a))return l.label}return r=="notify"?"Notify":r=="follow"?"Follow":r=="reblog"?"Reblog":r=="community"?"Community":r==="rc"?"RC":(console.warn("Unrecognized CustomJSON id:",r),"Other")}else{if(t=="vote")return e[1].weight>0?"Up":"Down";if(t=="transfer")return"Xfer";if(t.startsWith("limit"))return"Market";var n=e[0].split("_")[0];return n=n.charAt(0).toUpperCase()+n.slice(1),n=n.substring(0,9),n}}function P(e){return Object.keys(c).includes(e)&&c[e].label?c[e].label:(console.warn("Label not found for: ",e),"Other")}function u(e){return Object.keys(c).includes(e)&&c[e].color?c[e].color:"gray"}function w(){var e=prompt("Enter block number:",document.querySelector("#blockNum").innerText);e=parseInt(e)-1,!e||e<0?v():(document.querySelector("#blockNum").data=`${e+1}`,document.querySelector("#blockNum").innerText=`${e}`),y()}document.querySelector("button#gotoblock").onclick=e=>{w()};function x(e){document.querySelector("button#play").hidden?(document.querySelector("button#pause").hidden=!0,document.querySelector("button#play").hidden=!1):(document.querySelector("button#play").hidden=!0,document.querySelector("button#pause").hidden=!1)}document.querySelector("button#pause").onclick=e=>{x()};document.querySelector("button#play").onclick=e=>{x()};function Te(){document.querySelector("#flexCheckCustomJSONs").value?document.querySelector("#flexCheckCustomJSONs").value=!1:document.querySelector("#flexCheckCustomJSONs").value=!0}document.querySelector("#flexCheckCustomJSONs").onclick=e=>{Te()};function p(e){const s=h();if(e)var n=s+1;else var n=s-1;n=k(n,1,10),document.querySelector("#speedgauge").data=`${n}`,document.querySelector("#speedgauge").innerText=`${n}x`}document.querySelector("button#fastforward").onclick=e=>{p(!0)};document.querySelector("button#backward").onclick=e=>{p(!1)};function h(){document.querySelector("#speedgauge").data||(document.querySelector("#speedgauge").data="1.0");var e=parseFloat(document.querySelector("#speedgauge").data);return e}hive.api.setOptions({url:"https://api.deathwing.me/"});function v(){hive.api.getDynamicGlobalProperties(function(e,t){if(e){console.error(e);return}var r=t.current_witness;document.querySelector("#currentWitness").innerText=`${r}`;var o=t.head_block_number;document.querySelector("#blockNum").innerText=`${o}`,document.querySelector("#blockNum").data=`${o}`,y()})}function y(){var e=document.querySelector("#blockNum").data;if(!e){console.debug("Failed to find block");return}hive.api.getBlock(e,function(t,r){if(t){console.error(t);return}var o=r;if(!o||!o.transactions)return;const s=o.transactions.length;document.querySelector("#blockSize").innerText=`${s.toLocaleString()} transactions`,d3.select("svg#viz").selectAll("g").remove();var n=je(o.transactions);_e(n),d3.forceSimulation(n).force("center",d3.forceCenter(f/2,d/2)).force("collision",d3.forceCollide().radius(function(l){return k(l.label.length*6.25,20,40)})).on("tick",Ee).alpha(10),o.transactions.forEach(l=>{l.operations.forEach(a=>{a[0]==="custom_json"&&g(a)=="Other"&&console.warn("Unknown app",JSON.stringify(a))})}),document.querySelector("#blockNum").data==`${parseInt(e)}`&&(document.querySelector("#blockNum").data=`${parseInt(e)+1}`,document.querySelector("#blockNum").innerText=`${e}`,document.querySelector("#currentWitness").innerText=`${o.witness}`,document.querySelector("#timestamp").innerText=`${o.timestamp}`)}),console.info("Parsed block number:",e)}var O=new URLSearchParams(window.location.search);if(O.has("block")){var m=O.get("block"),m=parseInt(m);isNaN(m)||m<0?v():(document.querySelector("#blockNum").innerText=`${m}`,document.querySelector("#blockNum").data=`${m}`,y())}else v();function S(){document.querySelector("button#pause").hidden!=!0&&h()!=0&&y();var e=Math.abs(3e3/h());e!=1/0?setTimeout(()=>{S()},e):setTimeout(()=>{S()},1e3)}S();document.onkeydown=ze;function ze(e){e=e||window.event,e.keyCode=="38"||e.keyCode=="40"||(e.keyCode=="37"?p(!1):e.keyCode=="39"?p(!0):e.keyCode=="32"?x():e.keyCode=="83"&&w())}window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()});
