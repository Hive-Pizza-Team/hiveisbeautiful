(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const _={appNames:[],customJsonPrefixes:["archmage_"],hiveEngineSymbols:["ARCHMAGE","ARCHMAGEA","ARCHMAGEB","ARCHMAGEM"],color:"blue",label:"Archmage"},J={appNames:["actifit"],customJsonPrefixes:[],hiveEngineSymbols:[""],color:"red"},E={appNames:["beem"],color:"gray",label:"beem"},q={appNames:[],customJsonPrefixes:["cbm_"],hiveEngineSymbols:[""],color:"lightgreen"},A={appNames:[],customJsonPrefixes:[],hiveEngineSymbols:[""],color:"yellow-orange"},C={appNames:["CS"],color:"blue",label:"CS"},I={appNames:[],customJsonPrefixes:["dcrops"],hiveEngineSymbols:[""],color:"lightgreen",label:"dCrops"},j={appNames:["dBuzz"],color:"red",label:"dBuzz"},z={customJsonPrefixes:["dlux_"],label:"DLUX",color:"lightgreen"},L={appNames:[],color:"red",customJsonPrefixes:[],hiveEngineSymbols:[""],label:"Downvote"},T={appNames:["ecency"],color:"blue",label:"Ecency",customJsonPrefixes:["ecency_"],hiveEngineSymbols:[""]},M={appNames:["engage"],color:"blue",label:"Engage"},W={customJsonPrefixes:["exode"],label:"Exode"},$={appNames:[],color:"blue",customJsonPrefixes:["go_"],label:"GolemO"},H={appNames:[],color:"blue",customJsonPrefixes:["gls-"],hiveEngineSymbols:[""],label:"GLS"},D={appNames:[],color:"red",customJsonPrefixes:["ssc-mainnet","scot_"],hiveEngineSymbols:[""],label:"H-E"},U={"app-names":[],color:"lightgreen",customJsonPrefixes:["qwoyn_"],hiveEngineSymbols:["BUDS","BUDSX","EXP"],label:"HashKings"},R={color:"hotpink",customJsonPrefixes:["pp_video"],label:"HiveTube"},B={"app-names":[],color:"purple","custom-json-ids":[],hiveEngineSymbols:["ZING"],label:"Holo"},G={color:"yellow"},Z={appNames:["leothreads","leofinance"],color:"yellow",customJsonPrefixes:["leo_"],label:"INLEO",url:"https://inleo.io"},F={appNames:"la-colmena"},X={customJsonPrefixes:["lensy_"],label:"Lensy"},K={appNames:["liketu"],color:"bluegreen",label:"liketu",url:"https://www.liketu.com/"},V={color:"blue",customJsonPrefixes:["mole-miner-"],label:"MuTerra"},Q={color:"orange",customJsonPrefixes:["nftmart"],label:"NFTMart",url:"https://nftm.art"},Y={customJsonPrefixes:["nftsr_"],label:"NTFSR"},ee={customJsonPrefixes:["op_"],label:"OP"},oe={color:"gray"},te={customJsonPrefixes:["pm_"],label:"PKM",color:"orange"},ne={appNames:["peakd"],color:"lightgreen",customJsonPrefixes:["peakd_","beacon_custom_json"],label:"PeakD"},re={color:"bluegreen",customJsonPrefixes:["pigs_expired/1","reject_order/1","game_request/1","pack_purchase/1","confirm_order/1","fulfill_pigs/1","end_game/1","gmreq_","start_game/1","game_rewards/1","pig_upgrade/1","fulfill_points/1"],label:"Piggies"},se={appNames:["pizzabot"],color:"yellow",hiveEngineSymbols:["PIZZA"],label:"PIZZA",url:"https://hive.pizza"},le={appNames:["Poshtoken"],color:"yellow"},ce={color:"lightgreen"},ae={color:"yellow",customJsonPrefixes:["pp_"],label:"podping"},ie={label:"PoB",color:"gray"},ue={color:"bluegreen",customJsonPrefixes:["duat_"],label:"Ragnarok"},me={appNames:["somee"],color:"red",label:"Somee"},fe={appNames:["3speak"],color:"bluegreen",customJsonPrefixes:["spkcc_","3speak-"],hiveEngineSymbols:[""],label:"Spk"},de={appNames:["steemmonsters","splinterlands"],color:"green",customJsonPrefixes:["sm_","sl-","dev-sm_"],label:"SL"},pe={appNames:["steemmonsters"],color:"green",label:"Splintertalk"},be={color:"blue"},ge={color:"orange",customJsonPrefixes:["terracore_","tm_"],label:"Terracore"},ye={color:"orange"},he={appNames:"travelfeed",color:"orange",label:"Travelfeed"},ve={color:"blue"},Se={color:"blue",customJsonPrefixes:"vsc.",label:"VSC"},ke={color:"orange",label:"VIMM"},xe={appNames:["waivio"],color:"gray",customJsonPrefixes:["wobj_","waivio_"],label:"Waivio"},Ne={color:"yellow",customJsonPrefixes:["woo_"],hiveEngineSymbols:["WOO","WOOALPHA","WOOSATURN","WOORAVEN"],label:"WOO"},c={archmage:_,Actifit:J,beem:E,CBM:q,Comment:A,cryptoshots:C,dcrops:I,dbuzz:j,dlux:z,downvote:L,ecency:T,engage:M,exode:W,golemoverlord:$,gls:H,hiveengine:D,hashkings:U,"Hive.blog":{appNames:["hiveblog"],color:"yellow-orange",label:"hive.blog"},hivetube:R,holozing:B,Holybread:G,inleo:Z,lacolmena:F,lensy:X,liketu:K,muterra:V,nftmart:Q,nftshowroom:Y,oceanplanet:ee,Other:oe,peakmonsters:te,peakd:ne,piggericks:re,PIZZA:se,Posh:le,Post:ce,podping:ae,proofofbrain:ie,ragnarok:ue,somee:me,spk:fe,splinterlands:de,splintertalk:pe,STEMSocial:be,terracore:ge,Xfer:ye,travelfeed:he,Up:ve,vsc:Se,vimm:ke,waivio:xe,WOO:Ne},f=800,d=700;function v(e,t,r){return e<=t?t:e>=r?r:e}const Pe=()=>Math.random()<.5?-1:1,i=e=>e*Pe()*Math.random();function we(e){var t=d3.select("svg#viz").selectAll("g").data(e);t.enter().append("g").attr("class","node").each(function(r){d3.select(this).append("circle").attr("class",function(o){return`${o.color} stroke`}).attr("r",function(o){return v(o.label.length*6.25,20,40)}),d3.select(this).append("text").attr("dominant-baseline","central").attr("text-anchor","middle").text(function(o){return o.label}).style("font-size","17px")}),t.exit().remove()}function Oe(){var e=d3.select("svg#viz").selectAll("g");e.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}function _e(e){const t=b(e);var r=g(e),o;return t?o=u(t):o=u(r),[{label:r,color:o,x:f/2+i(100),y:d/2+i(100)}]}function Je(e){var t=[],r=e[1].json;try{r=JSON.parse(r)}catch(o){return console.warn("Invalid JSON:",o),[]}if(!r)return t;if(Array.isArray(r))for(const o of r){const s=k(o.contractPayload.symbol);if(!s)continue;const n=x(s),l=u(s);t.push({label:n,color:l,x:f/2+i(100),y:d/2+i(100)})}else if(r.contractPayload){const o=r.contractPayload.symbol,s=k(o);if(!s)return t;const n=x(s),l=u(s);console.debug(s,n,l),t.push({label:n,color:l,x:f/2+i(100),y:d/2+i(100)})}return t}function Ee(e){var t=[],r=e[1].id;r.startsWith("ssc-mainnet")&&(t=t.concat(Je(e)));const o=b(e);var s=g(e);s||console.error("missing label for:",o);var n;return o?n=u(o):n=u(s),t.push({label:s,color:n,x:f/2+i(100),y:d/2+i(100)}),t}function qe(e){const t=b(e);var r=g(e),o;return t?o=u(t):o=u(r),[{label:r,color:o,x:f/2+i(100),y:d/2+i(100)}]}function Ae(e){var t=[];return e.forEach(r=>{r.operations.forEach(o=>{const s=o[0];var n=[];s==="comment"?n=_e(o):s==="custom_json"?n=Ee(o):n=qe(o),t=t.concat(n)})}),t}function k(e){for(const[t,r]of Object.entries(c))if(r.hiveEngineSymbols&&r.hiveEngineSymbols.includes(e))return console.debug("from HE symbol appId",t),t}function b(e){const t=e[0];var r=e[1].json_metadata;if(r)var r=JSON.parse(r);if(r&&r.app){var o=r.app;typeof o=="string"?(o=o.split("/")[0],o=o.split("-mobile-")[0]):o.name&&(o=o.name)}if(o&&console.debug("JSON app name",o),o){for(const[n,l]of Object.entries(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(o.toLowerCase()))return console.debug("appId",n),n}console.warn("Did not find app in registry: ",o)}if(t=="custom_json"){var s=e[1].id;for(const[n,l]of Object.entries(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(s.startsWith(a))return console.debug("appId",n),n}}return null}function g(e){var t=e[0];if(t=="comment"){const l=b(e);return l&&!Object.keys(c[l]).includes("label")&&console.log(l,"missing label"),l&&c[l].label?c[l].label:t.charAt(0).toUpperCase()+t.slice(1)}else if(t=="custom_json"){var r=e[1].id,o=e[1].json,s=o.app;if(typeof s=="object"&&Object.keys(s).includes("name")&&(s=s.name),s){for(const l of Object.values(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(s))return console.debug("Labeled by app name:",l.label),l.label}}for(const l of Object.values(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(r.startsWith(a))return l.label}return r=="notify"?"Notify":r=="follow"?"Follow":r=="reblog"?"Reblog":r=="community"?"Community":r==="rc"?"RC":(console.warn("Unrecognized CustomJSON id:",r),"Other")}else{if(t=="vote")return e[1].weight>0?"Up":"Down";if(t=="transfer")return"Xfer";var n=e[0].split("_")[0];return n=n.charAt(0).toUpperCase()+n.slice(1),n=n.substring(0,9),n}}function x(e){return Object.keys(c).includes(e)&&c[e].label?c[e].label:(console.warn("Label not found for: ",e),"Other")}function u(e){return Object.keys(c).includes(e)&&c[e].color?c[e].color:"gray"}function P(){var e=prompt("Enter block number:",document.querySelector("#blockNum").innerText);e=parseInt(e)-1,!e||e<0?h():(document.querySelector("#blockNum").data=`${e+1}`,document.querySelector("#blockNum").innerText=`${e}`),y()}document.querySelector("button#gotoblock").onclick=e=>{P()};function S(e){document.querySelector("button#play").hidden?(document.querySelector("button#pause").hidden=!0,document.querySelector("button#play").hidden=!1):(document.querySelector("button#play").hidden=!0,document.querySelector("button#pause").hidden=!1)}document.querySelector("button#pause").onclick=e=>{S()};document.querySelector("button#play").onclick=e=>{S()};function p(e){const s=w();if(e)var n=s+1;else var n=s-1;n=v(n,-3,3),document.querySelector("span#speedgauge").data=`${n}`,document.querySelector("span#speedgauge").innerText=`${n}x`}document.querySelector("button#fastforward").onclick=e=>{p(!0)};document.querySelector("button#backward").onclick=e=>{p(!1)};function w(){document.querySelector("span#speedgauge").data||(document.querySelector("span#speedgauge").data="1.0");var e=parseFloat(document.querySelector("span#speedgauge").data);return e}hive.api.setOptions({url:"https://api.deathwing.me/"});function h(){hive.api.getDynamicGlobalProperties(function(e,t){if(e){console.error(e);return}var r=t.current_witness;document.querySelector("#currentWitness").innerText=`${r}`;var o=t.head_block_number;document.querySelector("#blockNum").innerText=`${o}`,document.querySelector("#blockNum").data=`${o}`,y()})}function y(){var e=document.querySelector("#blockNum").data;if(!e){console.debug("Failed to find block");return}hive.api.getBlock(e,function(t,r){if(t){console.error(t);return}var o=r;if(!o||!o.transactions)return;const s=o.transactions.length;document.querySelector("#blockSize").innerText=`${s.toLocaleString()} transactions`,d3.select("svg#viz").selectAll("g").remove();var n=Ae(o.transactions);we(n),d3.forceSimulation(n).force("center",d3.forceCenter(f/2,d/2)).force("collision",d3.forceCollide().radius(function(l){return v(l.label.length*6.25,20,40)})).on("tick",Oe).alpha(10),o.transactions.forEach(l=>{l.operations.forEach(a=>{a[0]==="custom_json"&&g(a)=="Other"&&console.warn("Unknown app",JSON.stringify(a))})}),document.querySelector("#blockNum").data==`${parseInt(e)}`&&(document.querySelector("#blockNum").data=`${parseInt(e)+1}`,document.querySelector("#blockNum").innerText=`${e}`,document.querySelector("#currentWitness").innerText=`${o.witness}`,document.querySelector("#timestamp").innerText=`${o.timestamp}`)}),console.info("Parsed block number:",e)}var N=new URLSearchParams(window.location.search);if(N.has("block")){var m=N.get("block"),m=parseInt(m);isNaN(m)||m<0?h():(document.querySelector("#blockNum").innerText=`${m}`,document.querySelector("#blockNum").data=`${m}`,y())}else h();function O(){var e=Math.abs(3e3/w());document.querySelector("button#pause").hidden!=!0&&y(),e!=1/0&&setTimeout(()=>{O()},e)}O();document.onkeydown=Ce;function Ce(e){e=e||window.event,e.keyCode=="38"||e.keyCode=="40"||(e.keyCode=="37"?p(!1):e.keyCode=="39"?p(!0):e.keyCode=="32"?S():e.keyCode=="83"&&P())}window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()});
